name: FTP Deploy to Production

on:
  push:
    branches:
      - main
      - master

jobs:
  deploy:
    name: Deploy to FTP Server
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      
      - name: List files to be deployed (debug)
        run: |
          echo "=== Themes directory ==="
          ls -la wp-content/themes/ || echo "themes directory not found"
          echo ""
          echo "=== Plugins directory ==="
          ls -la wp-content/plugins/ || echo "plugins directory not found"
          echo ""
          echo "=== Counting files in themes ==="
          find wp-content/themes -type f | wc -l || echo "0"
          echo ""
          echo "=== Counting files in plugins ==="
          find wp-content/plugins -type f | wc -l || echo "0"
      
      - name: Deploy Themes and Plugins to FTP
        uses: SamKirkland/FTP-Deploy-Action@v4.3.5
        with:
          server: 194.36.184.144
          username: u682875833
          password: ${{ secrets.FTP_PASSWORD }}
          local-dir: ./wp-content/
          server-dir: /domains/ntillimpsychotherapy.com/public_html/wp-content/
          log-level: verbose
          dangerous-clean-slate: false
          exclude: |
            **/.git*
            **/.git*/**
            **/.github/**
            **/.cursorrules
            **/.gitignore
            **/node_modules/**
            **/.env
            **/.env.*
            **/.DS_Store
            **/Thumbs.db
            **/themes/twenty*/
            **/themes/twentytwenty*/
            **/themes/twentytwentyone/**
            **/themes/twentytwentytwo/**
            **/themes/twentytwentythree/**
            **/themes/twentytwentyfour/**
            **/themes/twentytwentyfive/**
            **/uploads/**
            **/cache/**
            **/debug.log
            **/error_log
            **/debug-display.php
            **/.vscode/**
            **/.idea/**

